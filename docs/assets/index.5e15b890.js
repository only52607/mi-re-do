var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i;import{d as l,h as u,r as s,a as d,o as c,c as v,w as p,b as h,e as m,z as f,m as y,f as g,g as b,F as R,i as _,u as k,t as E,j as w,k as q,A as I,P as A,l as S,n as O,p as T,q as L,s as C,v as F,x as N,y as P,D as M,C as x,U as j,T as U,B as V,S as H,E as D,G as $,H as K,I as B,J as G,M as W,K as X,L as Q,N as z,O as Y,Q as J,R as Z}from"./vendor.33ec9ea5.js";const ee={id:"app"};var te=l({setup(e){u.locale("zh-cn");const t=s(f);return(e,n)=>{const i=d("router-view"),o=d("a-config-provider");return c(),v(o,{locale:t.value},{default:p((()=>[h("div",ee,[m(i)])])),_:1},8,["locale"])}}});let ne;const ie={},oe=function(e,t){if(!t)return e();if(void 0===ne){const e=document.createElement("link").relList;ne=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in ie)return;ie[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":ne,t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",t)})):void 0}))).then((()=>e()))};var re=l({props:{route:{type:null,required:!0}},setup:e=>(t,n)=>{var i;const o=d("router-link-icon"),r=d("a-menu-item");return c(),v(r,{key:null==(i=e.route.meta)?void 0:i.fullPath},{default:p((()=>{var t,n,i;return[m(o,{icon:null==(t=e.route.meta)?void 0:t.icon,text:null==(n=e.route.meta)?void 0:n.title,to:null==(i=e.route.meta)?void 0:i.fullPath},null,8,["icon","text","to"])]})),_:1})}}),ae=l({props:{route:{type:null,required:!0}},setup:e=>(t,n)=>{var i;const o=d("span-icon"),r=d("route-base-sub-menu",!0),a=d("a-sub-menu");return c(),v(a,y({key:`${null==(i=e.route.meta)?void 0:i.fullPath}`},t.$attrs),{title:p((()=>{var t,n;return[m(o,{icon:null==(t=e.route.meta)?void 0:t.icon,text:null==(n=e.route.meta)?void 0:n.title},null,8,["icon","text"])]})),default:p((()=>[(c(!0),g(R,null,b(e.route.children,(e=>{var t,n;return c(),g(R,null,[e.children&&0!=e.children.length?(c(),v(r,{route:e,key:null==(n=e.meta)?void 0:n.fullPath},null,8,["route"])):(c(),v(re,{route:e,key:null==(t=e.meta)?void 0:t.fullPath},null,8,["route"]))],64)})),256))])),_:1},16)}}),le=l({props:{routes:{type:Array,required:!0},currentRoute:{type:null,required:!0}},setup(e){const t=e.currentRoute,n=s([t.path]);return _((()=>t.path),(()=>{n.value=[t.path]})),(e,t)=>{const i=d("a-menu");return c(),v(i,{selectedKeys:n.value,"onUpdate:selectedKeys":t[0]||(t[0]=e=>n.value=e)},{default:p((()=>[(c(!0),g(R,null,b(k(qt)(k(It)),(e=>{var t,n;return c(),g(R,null,[e.children&&0!=e.children.length?(c(),v(ae,{route:e,key:null==(n=e.meta)?void 0:n.fullPath},null,8,["route"])):(c(),v(re,{route:e,key:null==(t=e.meta)?void 0:t.fullPath},null,8,["route"]))],64)})),256))])),_:1},8,["selectedKeys"])}}});const ue={baseURL:"mock-server",title:"LOGO",shortTitle:"LOGO",titleSeparator:" - ",titleReverse:!1,version:{}.VUE_APP_VERSION,copyright:"copyright"};var se,de,ce=Object.assign({},ue,{},{},{title:"MI-RE-DO",shortTitle:"MRD",copyright:"Copyright - @2021 MI-RE-DO 由Mirai-Reactivity-Ws强力驱动"}),ve=l({props:{collapsed:{type:Boolean,required:!0}},setup(e){const{title:t,shortTitle:n}=ce;return(i,o)=>(c(),g("div",null,E(e.collapsed?k(n):k(t)),1))}});(de=se||(se={}))[de.NORMAL=0]="NORMAL",de[de.ERROR_VERIFY_KEY=1]="ERROR_VERIFY_KEY",de[de.BOT_NOT_EXIST=2]="BOT_NOT_EXIST",de[de.SESSION_INVALID=3]="SESSION_INVALID",de[de.SESSION_INACTIVATED=4]="SESSION_INACTIVATED",de[de.TARGET_NOT_EXIST=5]="TARGET_NOT_EXIST",de[de.FILE_NOT_EXIST=6]="FILE_NOT_EXIST",de[de.NO_OPERATION_AUTH=10]="NO_OPERATION_AUTH",de[de.BOT_MUTED=20]="BOT_MUTED",de[de.MESSAGE_TOO_LONG=30]="MESSAGE_TOO_LONG",de[de.WRONG_VISIT=400]="WRONG_VISIT",de[de.ERROR_SERVER=500]="ERROR_SERVER";const pe=new Map([[se.NORMAL,"正常"],[se.ERROR_VERIFY_KEY,"错误的 auth key"],[se.BOT_NOT_EXIST,"指定的 Bot 不存在"],[se.SESSION_INVALID,"Session 失效或不存在"],[se.SESSION_INACTIVATED,"Session 未认证(未激活)"],[se.TARGET_NOT_EXIST,"发送消息目标不存在(指定对象不存在)"],[se.FILE_NOT_EXIST,"指定文件不存在，出现于发送本地图片"],[se.NO_OPERATION_AUTH,"无操作权限，指 Bot 没有对应操作的限权"],[se.BOT_MUTED,"Bot 被禁言，指 Bot 当前无法向指定群发送消息"],[se.MESSAGE_TOO_LONG,"消息过长"],[se.WRONG_VISIT,"错误的访问，如参数错误等"],[se.ERROR_SERVER,"服务器端错误的响应（mirai-console/mirai-api-http 背锅）"]]);function he(e){return pe.get(e)||"未知的错误"}function me(e){return{type:"Plain",text:e}}const fe={buildQuote:function(e){return{type:"Quote",id:e}},buildAt:function(e){return{type:"At",target:e,display:""}},buildAtAll:function(){return{type:"AtAll"}},buildFace:function(e,t=""){return{type:"Face",faceId:e,name:t}},buildPlain:me,buildImage:function(e=null,t=null,n=null){return{type:"Image",imageId:e,url:t,path:n}},buildFlashImage:function(e=null,t=null,n=null){return{type:"FlashImage",imageId:e,url:t,path:n}},buildVoice:function(e=null,t=null,n=null){return{type:"Voice",voiceId:e,url:t,path:n}},buildXml:function(e){return{type:"Xml",xml:e}},buildJson:function(e){return{type:"Json",json:e}},buildApp:function(e){return{type:"App",content:e}},buildPoke:function(e){return{type:"Poke",name:e}},buildMusicShare:function(e,t,n,i,o,r,a){return{type:"MusicShare",kind:e,title:t,summary:n,jumpUrl:i,pictureUrl:o,musicUrl:r,brief:a}}};function ye(e){return"string"==typeof e?e=[me(e)]:Array.isArray(e)||(e=[e]),e}var ge=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(t){r(t)}}function l(e){try{u(i.throw(e))}catch(t){r(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}u((i=i.apply(e,t||[])).next())}))};class be{constructor(e){this.client=e}sendRequestForResultAndCheck(e){return ge(this,void 0,void 0,(function*(){const t=yield this.client.sendRequestForResult(e);if(t.data.code&&0!=t.data.code)throw new Error(he(t.data.code));return delete t.data.code,delete t.data.msg,t}))}addMiraiEventListener(e){this.client.addMiraiEventListener(e)}removeMiraiEventListener(e){this.client.removeMiraiEventListener(e)}addOpenListener(e){var t;null===(t=this.client.websocket)||void 0===t||t.addEventListener("open",e)}addCloseListener(e){var t;null===(t=this.client.websocket)||void 0===t||t.addEventListener("close",e)}addErrorListener(e){var t;null===(t=this.client.websocket)||void 0===t||t.addEventListener("error",e)}emitEvent(e){this.client.emitMiraiEvent(e)}about(){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"about"})).data.data}))}botProfile(){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"botProfile"})).data}))}friendProfile(e){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"friendProfile",content:{target:e}})).data}))}memberProfile(e,t){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"memberProfile",content:{target:e,memberId:t}})).data}))}friendList(){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"friendList"})).data.data}))}groupList(){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"groupList"})).data.data}))}memberList(e){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"memberList",content:{target:e}})).data.data}))}messageFromId(e){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"messageFromId",content:{target:e}})).data.data}))}sendFriendMessage(e,t,n){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"sendFriendMessage",content:{messageChain:ye(e),target:t,quote:n}})).data}))}sendGroupMessage(e,t,n){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"sendGroupMessage",content:{messageChain:ye(e),target:t,quote:n}})).data}))}sendTempMessage(e,t,n,i){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"sendTempMessage",content:{messageChain:ye(e),qq:t,group:n,quote:i}})).data}))}sendImageMessage(e,t,n,i){return ge(this,void 0,void 0,(function*(){throw Error("Not yet implement.")}))}uploadImage(e,t){return ge(this,void 0,void 0,(function*(){throw Error("Not yet implement.")}))}uploadVoice(e,t){return ge(this,void 0,void 0,(function*(){throw Error("Not yet implement.")}))}uploadFileAndSend(e,t,n,i){return ge(this,void 0,void 0,(function*(){throw Error("Not yet implement.")}))}recall(e){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"recall",content:{target:e}})}))}sendNudge(e,t,n){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"sendNudge",content:{target:e,subject:t,kind:n}})}))}muteAll(e){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"muteAll",content:{target:e}})}))}unmuteAll(e){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"unmuteAll",content:{target:e}})}))}mute(e,t,n){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"mute",content:{target:e,memberId:t,time:n}})}))}unmute(e,t){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"unmute",content:{target:e,memberId:t}})}))}kick(e,t,n){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"kick",content:{target:e,memberId:t,msg:n}})}))}quit(e){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"quit",content:{target:e}})}))}groupConfig(e,t){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"groupConfig",content:{target:e,config:t}})).data}))}memberInfo(e,t,n){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"memberInfo",content:{target:e,memberId:t,info:n}})).data}))}managers(){return ge(this,void 0,void 0,(function*(){throw Error("Not yet implement.")}))}setEssence(e){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"setEssence",content:{target:e}})}))}groupFileList(e="",t,n,i){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"file_list",content:{id:e,target:t,group:n,qq:i}})).data}))}groupFileInfo(e="",t,n,i){return ge(this,void 0,void 0,(function*(){return(yield this.sendRequestForResultAndCheck({command:"file_info",content:{id:e,target:t,group:n,qq:i}})).data}))}groupFileRename(e="",t,n,i,o){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"file_rename",content:{id:e,renameTo:t,target:n,group:i,qq:o}})}))}groupMkdir(e="",t,n,i,o){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"file_mkdir",content:{id:e,directoryName:t,target:n,group:i,qq:o}})}))}groupFileMove(e="",t,n,i,o){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"file_move",content:{id:e,moveTo:t,target:n,group:i,qq:o}})}))}groupFileDelete(e="",t,n,i){return ge(this,void 0,void 0,(function*(){yield this.sendRequestForResultAndCheck({command:"file_delete",content:{id:e,target:t,group:n,qq:i}})}))}}class Re{constructor(e){this.options=e,this.promiseHandlers=new Map,this.eventListeners=new Set,this.currentSyncId=parseInt(Date.now().toString())}getCurrentSyncIdAndIncrease(){return this.currentSyncId++}sendRequestRaw(e){if(!this.websocket)throw new Error("The websocket instance has not been initialized.");if(this.websocket.readyState!=w.OPEN)throw new Error("The websocket connection has not been opened.");this.websocket.send(JSON.stringify(e))}buildWsAddress(e,t){return t.verifyKey?`${e}?verifyKey=${t.verifyKey}&qq=${t.qq}`:`${e}?sessionKey=${t.sessionKey}`}isAvaliable(){return this.websocket&&this.websocket.readyState==w.OPEN}addMiraiEventListener(e){this.eventListeners.add(e)}removeMiraiEventListener(e){this.eventListeners.delete(e)}emitMiraiEvent(e){this.eventListeners.forEach((t=>{t(e)}))}sendRequestForResult(e){var t,n;const i=this.getCurrentSyncIdAndIncrease().toString(),o=new Promise(((e,t)=>{this.promiseHandlers.set(i,{resolve:e,reject:t})}));return this.sendRequestRaw(Object.assign({syncId:i},e)),setTimeout((()=>{var e;this.promiseHandlers.has(i)&&(null===(e=this.promiseHandlers.get(i))||void 0===e||e.reject(new Error(`Response timeout waiting for the packet ${i}.`)),this.promiseHandlers.delete(i))}),null!==(n=null===(t=this.options)||void 0===t?void 0:t.maxWaitTime)&&void 0!==n?n:5e3),o}connect(e){var t,n;this.websocket=new w(this.buildWsAddress(e.address,e.authentication)),this.initWebSocket(this.websocket);const i=new Promise(((e,t)=>{this.authenticateHandler={resolve:e,reject:t}}));return setTimeout((()=>{var e;this.authenticateHandler&&(null===(e=this.authenticateHandler)||void 0===e||e.reject(new Error("Response timeout waiting for connection.")),this.authenticateHandler=void 0)}),null!==(n=null===(t=this.options)||void 0===t?void 0:t.maxWaitTime)&&void 0!==n?n:5e3),i}disconnect(){if(!this.websocket)throw new Error("The websocket instance has not been initialized.");this.websocket.close()}initWebSocket(e){e.onmessage=e=>{var t,n,i,o;const r=JSON.parse(e.data.toString());switch(r.syncId){case"":this.authenticateHandler&&(null===(t=this.authenticateHandler)||void 0===t||t.resolve(r.data)),this.promiseHandlers.clear(),this.eventListeners.clear(),this.authenticateHandler=void 0;break;case null!==(i=null===(n=this.options)||void 0===n?void 0:n.reservedSyncId)&&void 0!==i?i:"-1":this.eventListeners.forEach((e=>{e(r.data)}));break;default:if(this.authenticateHandler){const e=r;null!=e.code&&null!=e.msg&&this.authenticateHandler.reject(new Error(he(e.code)));break}const e=null===(o=this.promiseHandlers.get(r.syncId))||void 0===o?void 0:o.resolve;e&&e({data:r.data}),this.promiseHandlers.delete(r.syncId)}},e.addEventListener("close",(()=>{this.authenticateHandler&&this.authenticateHandler.reject(new Error("Connect failed. (Parameter error)"))})),e.addEventListener("error",(e=>{this.authenticateHandler&&this.authenticateHandler.reject(e.error)}))}}var _e=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(t){r(t)}}function l(e){try{u(i.throw(e))}catch(t){r(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}u((i=i.apply(e,t||[])).next())}))};const ke=s(void 0),Ee=s(!1);function we(){return ke}function qe(e){Ee.value=!1,ke.value=void 0,ke.value=e,Ee.value=!0,ke.value.addCloseListener((()=>{Ee.value=!1}))}const Ie=s();let Ae=!1;function Se(){function e(){return _e(this,void 0,void 0,(function*(){ke.value?Ie.value=yield ke.value.about():Ie.value=void 0}))}return Ae||(q((()=>null!=ke.value),{scheduler:e}),e(),Ae=!0),{pluginInfo:Ie,emitUpdate:e}}var Oe=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(t){r(t)}}function l(e){try{u(i.throw(e))}catch(t){r(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}u((i=i.apply(e,t||[])).next())}))};const Te=we(),Le=s(),Ce=s("pending");let Fe=!1;function Ne(){function e(){return Oe(this,void 0,void 0,(function*(){if(!Te.value)return Le.value=void 0,void(Ce.value="pending");Ce.value="loading",Le.value=yield Te.value.botProfile(),Ce.value="done"}))}return Fe||(q((()=>null!=Te.value),{scheduler:e}),e(),Fe=!0),{botProfile:Le,state:Ce,emitUpdate:e}}function Pe(e){const t=s(),n=s("pending");function i(){return Oe(this,void 0,void 0,(function*(){if(!Te.value)return t.value=void 0,void(n.value="pending");const i=k(e);i&&(n.value="loading",t.value=yield Te.value.friendProfile(i),n.value="done")}))}return q((()=>[null!=Te.value,k(e)]),{scheduler:i}),i(),{profile:t,state:n,emitUpdate:i}}const Me=new Map,xe=we(),je=e=>{Me.forEach(((t,n)=>{n(e)&&t.push(e)}))};q((()=>{xe.value&&xe.value.addMiraiEventListener(je)}));var Ue=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(t){r(t)}}function l(e){try{u(i.throw(e))}catch(t){r(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}u((i=i.apply(e,t||[])).next())}))};const Ve=we(),He=s(),De=s("pending");let $e=!1;function Ke(){function e(){return Ue(this,void 0,void 0,(function*(){if(!Ve.value)return De.value="pending",void(He.value=void 0);De.value="loading",He.value=yield Ve.value.friendList(),De.value="done"}))}return $e||(q((()=>null!=Ve.value),{scheduler:e}),e(),$e=!0),{friends:He,state:De,emitUpdate:e}}const Be=s(),Ge=s("pending");let We=!1;function Xe(){function e(){return Ue(this,void 0,void 0,(function*(){if(!Ve.value)return Ge.value="pending",void(Be.value=void 0);Ge.value="loading",Be.value=yield Ve.value.groupList(),Ge.value="done"}))}return We||(q((()=>null!=Ve.value),{scheduler:e}),e(),We=!0),{groups:Be,state:Ge,emitUpdate:e}}function Qe(e){const t=s(),n=s("pending");function i(){return Ue(this,void 0,void 0,(function*(){if(!Ve.value)return n.value="pending",void(t.value=void 0);const i=k(e);if(!i)return n.value="pending",void(t.value=void 0);n.value="loading",t.value=yield Ve.value.memberList(i),n.value="done"}))}return q((()=>[null!=Ve.value,k(e)]),{scheduler:i}),i(),{members:t,state:n,emitUpdate:i}}var ze,Ye,Je=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(t){r(t)}}function l(e){try{u(i.throw(e))}catch(t){r(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}u((i=i.apply(e,t||[])).next())}))};function Ze(e){return Je(this,void 0,void 0,(function*(){const t=new Re,n=yield t.connect(e);return{api:new be(t),authentication:n}}))}(Ye=ze||(ze={})).Poke="Poke",Ye.ShowLove="ShowLove",Ye.Like="Like",Ye.Heartbroken="Heartbroken",Ye.SixSixSix="SixSixSix",Ye.FangDaZhao="FangDaZhao";var et=l({props:{nickname:{type:null,required:!1},userId:{type:Number,required:!0}},setup:e=>(t,n)=>{const i=d("a-avatar");return c(),v(i,{src:`https://q.qlogo.cn/headimg_dl?bs=qq&dst_uin=${e.userId}&src_uin=www.jlwz.cn&fid=blog&spec=100`,alt:e.nickname},null,8,["src","alt"])}});const tt={id:"user-dropdown-title"};var nt=l({props:{bot:{type:null,required:!0},botId:{type:null,required:!0}},emits:["menu-select"],setup:e=>(t,n)=>{const i=d("a-divider"),o=d("a-menu-item"),r=d("a-menu"),a=d("a-dropdown");return c(),v(a,null,{overlay:p((()=>[m(r,null,{default:p((()=>[m(o,null,{default:p((()=>[h("span",null,[m(k(I)),m(i,{type:"vertical"}),h("span",{onClick:n[0]||(n[0]=e=>t.$emit("menu-select","connect"))},"连接服务器")])])),_:1}),m(o,null,{default:p((()=>[h("span",null,[m(k(A)),m(i,{type:"vertical"}),h("span",{onClick:n[1]||(n[1]=e=>t.$emit("menu-select","show-profile"))},"Bot资料")])])),_:1})])),_:1})])),default:p((()=>{var t,n,o,r;return[h("span",tt,[S(E(null!=(n=null==(t=e.bot)?void 0:t.nickname)?n:"未连接")+" ",1),m(i,{type:"vertical"}),m(et,{size:"small","user-id":null!=(o=e.botId)?o:0,nickname:null==(r=e.bot)?void 0:r.nickname},null,8,["user-id","nickname"])])]})),_:1})}});const it=S("ws://"),ot=S("all"),rt=S("message"),at=S("event"),lt=S("连接");var ut=l({props:{visible:{type:Boolean,required:!0},connecting:{type:Boolean,required:!0},connectionInfo:{type:null,required:!0}},emits:["connect"],setup(e,{emit:t}){var n,i,o,r,a,l,u,h,f,g,b;const R=e,_=s(),E=null==(i=null==(n=R.connectionInfo)?void 0:n.address)?void 0:i.match(/ws:\/\/(.+)\/(all|message|event)/),w=O({host:null!=(o=null==E?void 0:E[1])?o:"127.0.0.1:8082",channel:null!=(r=null==E?void 0:E[2])?r:"all",verifyKey:null!=(u=null==(l=null==(a=R.connectionInfo)?void 0:a.authentication)?void 0:l.verifyKey)?u:"1234567890",qq:null!=(b=null==(g=null==(f=null==(h=R.connectionInfo)?void 0:h.authentication)?void 0:f.qq)?void 0:g.toString())?b:""}),q={verifyKey:[{required:!0,message:"请输入Verify Key",trigger:"blur"}],qq:[{required:!0,message:"请输入QQ号",trigger:"blur"},{min:1,max:30,message:"请输入正确的QQ号",trigger:"blur"}]};function I(){0!=w.channel.length?0!=w.qq.length?_.value.validate().then((()=>{t("connect",{address:`ws://${w.host}/${w.channel}`,authentication:{verifyKey:w.verifyKey,qq:parseInt(w.qq)}})})):T.warning("请输入qq号"):T.warning("请输入verify key")}return(t,n)=>{const i=d("a-select-option"),o=d("a-select"),r=d("a-input"),a=d("a-form-item"),l=d("a-button"),u=d("a-form"),s=d("a-modal");return c(),v(s,y({title:"连接到 MiraiConsole"},t.$attrs,{visible:e.visible,footer:null}),{default:p((()=>[m(u,{rules:q,model:k(w),ref:_},{default:p((()=>[m(a,{label:"通道"},{default:p((()=>[m(r,{value:k(w).host,"onUpdate:value":n[1]||(n[1]=e=>k(w).host=e)},{addonBefore:p((()=>[it])),addonAfter:p((()=>[m(o,{value:k(w).channel,"onUpdate:value":n[0]||(n[0]=e=>k(w).channel=e)},{default:p((()=>[m(i,{value:"all"},{default:p((()=>[ot])),_:1}),m(i,{value:"message"},{default:p((()=>[rt])),_:1}),m(i,{value:"event"},{default:p((()=>[at])),_:1})])),_:1},8,["value"])])),_:1},8,["value"])])),_:1}),m(a,{label:"Verify Key"},{default:p((()=>[m(r,{value:k(w).verifyKey,"onUpdate:value":n[2]||(n[2]=e=>k(w).verifyKey=e)},null,8,["value"])])),_:1}),m(a,{label:"QQ"},{default:p((()=>[m(r,{value:k(w).qq,"onUpdate:value":n[3]||(n[3]=e=>k(w).qq=e)},null,8,["value"])])),_:1}),m(a,null,{default:p((()=>[m(l,{type:"primary",loading:e.connecting,onClick:I},{default:p((()=>[lt])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])),_:1},16,["visible"])}}});const st=L("connection:mirai-console-websocket",{});function dt(){return st}function ct(e,t){if(e&&t)return e[0]==t[0]&&e[1]==t[1]}const vt=L("chat-sessions",[]);function pt(){return vt}function ht(e,t){vt.value.find((n=>n.identity[0]==t.id&&n.identity[1]==e))||vt.value.push({type:e,contact:t,identity:[t.id,e],unreadCount:0,events:[]})}function mt(e){return`${e[0]} ${e[1]}`}function ft(e){const t=vt.value.findIndex((t=>mt(t.identity)==e));return t<0?{index:t,session:void 0}:{index:t,session:vt.value[t]}}const yt=s();function gt(){return yt}function bt(e){const l=function(e){switch(e.type){case"FriendMessage":return{identity:[e.sender.id,"friend"],type:"friend",contact:e.sender};case"GroupMessage":return{identity:[e.sender.group.id,"group"],type:"group",contact:e.sender.group};case"TempMessage":return{identity:[e.sender.id,"temp"],type:"temp",contact:e.sender};case"SentMessage":return{identity:[e.target.id,e.targetType],type:e.targetType,contact:e.target}}}(e);if(!l)return;const u=vt.value.find((e=>ct(e.identity,l.identity)));var s;u?(u.events.push(e),"SentMessage"==e.type||ct(yt.value,u.identity)||u.unreadCount++):vt.value.push((s=((e,t)=>{for(var n in t||(t={}))o.call(t,n)&&a(e,n,t[n]);if(i)for(var n of i(t))r.call(t,n)&&a(e,n,t[n]);return e})({},l),t(s,n({events:[e],unreadCount:1}))))}let Rt=!1;const _t=we();var kt=l({props:{profile:{type:null,required:!0},userId:{type:Number,required:!0}},setup:e=>(t,n)=>{const i=d("a-empty"),o=d("a-descriptions-item"),r=d("a-descriptions");return e.profile?(c(),v(r,{key:1},{default:p((()=>[m(o,{label:"ID",span:3},{default:p((()=>[S(E(e.userId),1)])),_:1}),m(o,{label:"性别",span:3},{default:p((()=>[S(E("FEMALE"==e.profile.sex?"女":"MALE"==e.profile.sex?"男":"未知"),1)])),_:1}),m(o,{label:"等级",span:3},{default:p((()=>[S(E(e.profile.level),1)])),_:1}),m(o,{label:"年龄",span:3},{default:p((()=>[S(E(e.profile.age),1)])),_:1}),m(o,{label:"邮箱",span:3},{default:p((()=>[S(E(e.profile.email),1)])),_:1})])),_:1})):(c(),v(i,{key:0}))}}),Et=l({props:{bot:{type:null,required:!0},botId:{type:null,required:!0}},setup:e=>(t,n)=>{var i;const o=d("a-modal");return c(),v(o,y({title:null==(i=e.bot)?void 0:i.nickname},t.$attrs,{footer:null}),{default:p((()=>{var t;return[m(kt,{"user-id":null!=(t=e.botId)?t:0,profile:e.bot},null,8,["user-id","profile"])]})),_:1},16,["title"])}}),wt=l({setup(e){const{botProfile:t}=Ne(),n=dt();let i;const o=s(!1),r=s(!1);C();const a=F(),l=s(!0),u=s(!1),f=we();function y(){T.warning("请先连接服务器"),null==f.value&&(o.value=!0)}function g(){f.value?o.value=!1:T.warning("请先连接到服务器")}function b(){return n.value&&n.value.address&&n.value.authentication&&n.value.authentication.qq&&n.value.authentication.verifyKey}async function R(e){switch(e){case"connect":o.value=!0;break;case"show-profile":r.value=!0}}async function w(e){var t;try{u.value=!0;const{api:t}=await Ze(e);qe(t),o.value=!1,P.success({message:"连接服务器成功"}),n.value=e}catch(i){const e=null!=(t=null==i?void 0:i.message)?t:"";T.error(`连接服务器失败!  ${e}`)}u.value=!1}return function(e){function t(){_t.value&&!Rt&&(_t.value.addMiraiEventListener(bt),Rt=!0,e())}_((()=>null!=_t.value),t),t()}((()=>{P.success({message:"事件监听已启动"})})),_((()=>u.value),(()=>{u.value||!i?u.value&&(i=T.loading("正在连接服务器")):i()})),N((async()=>{f.value||(n.value&&b()?async function(){if(n.value&&b()){try{u.value=!0;const{api:e}=await Ze(n.value);qe(e),o.value=!1,P.success({message:"自动连接服务器成功"})}catch(e){P.error({message:"自动连接服务器失败"}),y(),console.log(e)}u.value=!1}}():y())})),(e,i)=>{const s=d("a-layout-sider"),f=d("menu-switch"),y=d("a-layout-header"),b=d("router-view"),_=d("a-layout-content"),q=d("a-layout");return c(),v(q,{id:"base-layout",style:{height:"100%",overflow:"hidden"}},{default:p((()=>{var e,d;return[m(s,{collapsed:l.value,"onUpdate:collapsed":i[0]||(i[0]=e=>l.value=e),trigger:null,collapsible:""},{default:p((()=>[m(k(ve),{collapsed:l.value,id:"logo"},null,8,["collapsed"]),m(k(le),{theme:"dark",mode:"inline",routes:k(It),"current-route":k(a)},null,8,["routes","current-route"])])),_:1},8,["collapsed"]),m(q,null,{default:p((()=>[m(y,{id:"header"},{default:p((()=>{var e,o;return[m(f,{id:"switch",collapsed:l.value,"onUpdate:collapsed":i[1]||(i[1]=e=>l.value=e)},null,8,["collapsed"]),h("span",null,E(k(a).meta.title),1),m(nt,{"bot-id":null==(o=null==(e=k(n))?void 0:e.authentication)?void 0:o.qq,bot:k(t),onMenuSelect:R},null,8,["bot-id","bot"])]})),_:1}),m(_,{id:"content"},{default:p((()=>[m(b)])),_:1})])),_:1}),m(ut,{connecting:u.value,visible:o.value,onConnect:w,onCancel:g,"connection-info":k(n)},null,8,["connecting","visible","connection-info"]),m(Et,{visible:r.value,"bot-id":null==(d=null==(e=k(n))?void 0:e.authentication)?void 0:d.qq,bot:k(t),onCancel:i[2]||(i[2]=()=>r.value=!1)},null,8,["visible","bot-id","bot"])]})),_:1})}}});wt.__scopeId="data-v-4cd665e6",l({setup(e){const t=F();return(e,n)=>{const i=d("a-page-header"),o=d("router-view");return c(),g(R,null,[m(i,{title:k(t).meta.title,"sub-title":k(t).meta.subTitle,onBack:n[0]||(n[0]=()=>e.$router.go(-1)),style:{background:"#fff"}},{extra:p((()=>[])),_:1},8,["title","sub-title"]),m(o)],64)}}});function qt(e){const t=[];return e.filter((e=>{var t,n;return!(null==(t=e.meta)?void 0:t.hiddien)||1!=(null==(n=e.meta)?void 0:n.hiddien)})).forEach((e=>{var n,i;(null==(n=e.meta)?void 0:n.flattened)&&1==(null==(i=e.meta)?void 0:i.flattened)&&e.children&&0!=e.children.length?t.push(...qt(e.children)):t.push(e)})),t}const It=function e(t,n=""){return t.filter((e=>!0)).map((t=>(t.meta||(t.meta={}),t.meta.fullPath=t.path.startsWith("/")?t.path:D.resolve(n,t.path),!t.meta.title&&t.name&&(t.meta.title=t.name.toString()),t.children&&(t.children=e(t.children,t.meta.fullPath)),t)))}([{path:"/",component:wt,meta:{flattened:!0},children:[{path:"",name:"home",component:()=>oe((()=>import("./home.d107bd75.js")),["/assets/home.d107bd75.js","/assets/home.dddf82db.css","/assets/vendor.33ec9ea5.js"]),meta:{title:"主页",icon:M}},{path:"session",name:"session",component:()=>oe((()=>import("./index.54a3a184.js")),["/assets/index.54a3a184.js","/assets/index.97ac288c.css","/assets/MemberList.vue_vue&type=script&setup=true&lang.dd2b1256.js","/assets/vendor.33ec9ea5.js"]),meta:{title:"会话",icon:x}},{path:"friend",name:"friend",component:()=>oe((()=>import("./index.a41da56b.js")),["/assets/index.a41da56b.js","/assets/vendor.33ec9ea5.js"]),meta:{title:"好友",icon:j}},{path:"group",name:"group",component:()=>oe((()=>import("./index.0f3a6e91.js")),["/assets/index.0f3a6e91.js","/assets/MemberList.vue_vue&type=script&setup=true&lang.dd2b1256.js","/assets/vendor.33ec9ea5.js"]),meta:{title:"群聊",icon:U}},{path:"plugin",name:"plugin",component:()=>oe((()=>import("./index.48916f41.js")),["/assets/index.48916f41.js","/assets/vendor.33ec9ea5.js"]),meta:{title:"插件",icon:V}},{path:"setting",name:"setting",component:()=>oe((()=>import("./index.151fd6cb.js")),["/assets/index.151fd6cb.js","/assets/vendor.33ec9ea5.js"]),meta:{title:"配置",icon:H}}]}]),At=$({history:K("/"),routes:It});const St={class:"editable-cell"},Ot={key:0,class:"editable-cell-input-wrapper"},Tt={key:1,class:"editable-cell-text-wrapper"};var Lt=l({props:{value:{type:null,required:!0}},emits:["change","update:value"],setup(e,{emit:t}){const n=e,i=s(""),o=s(!1),r=s("");function a(){o.value=!1,t("update:value",i.value),t("change",i.value,r.value)}function l(){var e;n.value&&(i.value=null==(e=n.value)?void 0:e.toString()),r.value=i.value,o.value=!0}return(t,n)=>{const r=d("a-input");return c(),g("div",St,[o.value?(c(),g("div",Ot,[m(k(B),{class:"editable-cell-icon-check",onClick:a}),m(r,{value:i.value,"onUpdate:value":n[0]||(n[0]=e=>i.value=e),onPressEnter:a},null,8,["value"])])):(c(),g("div",Tt,[m(k(G),{class:"editable-cell-icon",onClick:l}),S(" "+E(e.value||" "),1)]))])}}}),Ct=l({props:{collapsed:Boolean},setup:e=>(t,n)=>e.collapsed?(c(),v(k(W),{key:0,class:"trigger",onClick:n[0]||(n[0]=e=>t.$emit("update:collapsed",!1))})):(c(),v(k(X),{key:1,class:"trigger",onClick:n[1]||(n[1]=e=>t.$emit("update:collapsed",!0))}))});Ct.__scopeId="data-v-a30e1908";var Ft=l({props:{icon:Function,text:String,to:String},setup:e=>(t,n)=>{const i=d("router-link");return c(),g(R,null,[null!=e.icon?(c(),v(Q(e.icon),{key:0})):z("",!0),h("span",null,E(e.text),1),null!=e.to?(c(),v(i,{key:1,to:e.to},null,8,["to"])):z("",!0)],64)}}),Nt=l({props:{icon:Function,text:String},setup:e=>(t,n)=>(c(),g("span",null,[null!=e.icon?(c(),v(Q(e.icon),{key:0})):z("",!0),h("span",null,E(e.text),1)]))});const Pt=["src"];var Mt=l({props:{visible:{type:Boolean,required:!0},imageUrl:{type:String,required:!0}},emits:["changeTitle","update:visible"],setup:(e,{emit:t})=>(t,n)=>{const i=d("a-modal");return c(),v(i,y(t.$attrs,{visible:e.visible,footer:null,onCancel:n[0]||(n[0]=()=>t.$emit("update:visible",!1))}),{default:p((()=>[h("img",{alt:"example",style:{width:"100%"},src:e.imageUrl},null,8,Pt)])),_:1},16,["visible"])}}),xt={install(e,...t){e.component("EditableCell",Lt),e.component("MenuSwitch",Ct),e.component("RouterLinkIcon",Ft),e.component("SpanIcon",Nt),e.component("ImageModal",Mt)}};function jt(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:i}=e,o=s(!1),r=s(!1);return{updateServiceWorker:function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i}=e;let o;return"serviceWorker"in navigator&&(o=new Y("/sw.js",{scope:"/"}),o.addEventListener("activated",(e=>{e.isUpdate?window.location.reload():null==i||i()})),o.register({immediate:t}).then((e=>e))),async(e=!0)=>{}}({immediate:t,onNeedRefresh(){o.value=!0,null==n||n()},onOfflineReady(){r.value=!0,null==i||i()}}),offlineReady:r,needRefresh:o}}const Ut={key:0,class:"pwa-toast",role:"alert"},Vt={class:"message"},Ht={key:0},Dt={key:1};l({setup(e){const{offlineReady:t,needRefresh:n,updateServiceWorker:i}=jt(),o=async()=>{t.value=!1,n.value=!1};return(e,r)=>k(t)||k(n)?(c(),g("div",Ut,[h("div",Vt,[k(t)?(c(),g("span",Ht,"App ready to work offline")):(c(),g("span",Dt,"New content available, click on reload button to update."))]),k(n)?(c(),g("button",{key:0,onClick:r[0]||(r[0]=e=>k(i)())},"Reload")):z("",!0),h("button",{onClick:o},"Close")])):z("",!0)}});window.global=window;const $t=J(te);$t.use(At),$t.use(Z),$t.use(xt),$t.mount("#app");export{et as _,Se as a,dt as b,ce as c,Mt as d,Pe as e,ft as f,Qe as g,kt as h,pt as i,gt as j,we as k,ct as l,fe as m,Ke as n,Xe as o,ht as p,mt as s,Ne as u};
